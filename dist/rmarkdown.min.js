var rmarkdown=function(){function t(t){this._div=t,this._sourceDiv=document.createElement("div"),this._sourceDiv.setAttribute("contenteditable",!0),this._sourceDiv.textContent="Type something for me",this._htmlDiv=document.createElement("div"),this._div.appendChild(this._htmlDiv),this._div.appendChild(this._sourceDiv),this._lines=[],this.attachEvents()}return t.prototype.attachEvents=function(){function t(t){if(n.isMyEvent(t)){var e=marked(n._sourceDiv.textContent);n._lines[i]=n._sourceDiv.textContent;var o=document.createElement("span");o.setAttribute("data-line-no",i),o.innerHTML=e,n.setEditListener(o),n._htmlDiv.appendChild(o),n._sourceDiv.textContent="",i++}}function e(){setTimeout(function(){n.placeCaretAtEnd(n._sourceDiv)},200)}var n=this,i=0;n._sourceDiv.addEventListener("keydown",t),n._sourceDiv.addEventListener("mousedown",function(t){t.stopPropagation()}),n._div.addEventListener("mousedown",e),document.addEventListener("mousedown",function(){})},t.prototype.setEditListener=function(t){function e(e){e.stopPropagation(),t.innerHTML='<div contenteditable="true" id="my-god-editing">'+o._lines[d]+"</div>",setTimeout(function(){o.placeCaretAtEnd(t.firstChild)},200),t.firstChild.addEventListener("mousedown",function(t){t.stopPropagation()},!0)}function n(t){o.isMyEvent(t)&&(i.call(this),o.placeCaretAtEnd(o._sourceDiv))}function i(){var e=marked(this.textContent);o._lines[d]=this.textContent,t.firstChild=null,t.innerHTML=e}var o=this,d=t.getAttribute("data-line-no");t.addEventListener("mousedown",e),t.addEventListener("keyup",n)},t.prototype.placeCaretAtEnd=function(t){if(t.focus(),"undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange){var e=document.createRange();e.selectNodeContents(t),e.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(e)}else if("undefined"!=typeof document.body.createTextRange){var i=document.body.createTextRange();i.moveToElementText(t),i.collapse(!1),i.select()}},t.prototype.markdown=function(){return this._lines.join("\n")},t.prototype.html=function(){return this._htmlDiv.outerHTML},t.prototype.isMyEvent=function(t){return 13===t.keyCode&&!t.shiftKey},t}();